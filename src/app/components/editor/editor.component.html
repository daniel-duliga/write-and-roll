<div class="container" [ngStyle]="{ 'display': minimized ? 'none' : 'flex' }">
    <!-- Header -->
    <div class="header shadow-down">
        <!-- Title -->
        <div class="header-separator"></div>
        <div class="title" matTooltip="Minimize" (click)="toggleMinimize(true)">
            {{ this.formattedName }}
        </div>

        <!-- Save button -->
        <span class="buttons-container" *ngIf="this.isDirty">
            <div class="header-separator"></div>
            <button
                class="header-button"
                mat-button
                matTooltip="Save (CTRL + S)"
                [style]="isDirty ? { 'color': 'red' } : {}"
                (click)="this.save()"
            >
                <mat-icon>save</mat-icon>
            </button>
        </span>

        <!-- Move buttons -->
        <div class="header-separator"></div>
        <button class="header-button" mat-button matTooltip="Move left" (click)="move('left')">
            <mat-icon>chevron_left</mat-icon>
        </button>
        <button class="header-button" mat-button matTooltip="Move right" (click)="move('right')">
            <mat-icon>chevron_right</mat-icon>
        </button>
        
        <!-- Options Menu -->
        <button class="header-button" mat-button matTooltip="Options" [matMenuTriggerFor]="menu">
            <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="this.onRename.emit()">
                <mat-icon>drive_file_rename_outline</mat-icon>
                <span>Rename</span>
            </button>
            <button mat-menu-item (click)="this.onDelete.emit()">
                <mat-icon>delete</mat-icon>
                <span>Delete</span>
            </button>
            <div class="menu-separator"></div>
            <button mat-menu-item (click)="this.onOpenNote.emit()">
                <mat-icon>description</mat-icon>
                <span>Open Note</span>
            </button>
            <div class="menu-separator"></div>
            <button mat-menu-item [routerLink]="'/import-export'">
                <mat-icon>sync</mat-icon>
                <span>Import/Export</span>
            </button>
          </mat-menu>
        
        <!-- Close button -->
        <div class="header-separator"></div>
        <button mat-button class="header-button" matTooltip="Close" (click)="this.close()">
            <mat-icon class="close-button-icon">close</mat-icon>
        </button>
    </div>
    
    <!-- Editor -->
    <div class="editor">
        <ngx-codemirror
            class="code-mirror"
            #ngxCodeMirror
            [(ngModel)]="this.note.content"
            [options]="{
                theme: 'default',
                mode: this.mode,
                lineWrapping: true,
                inputStyle: 'textarea',
                lineNumbers: true,
                foldGutter: true,
                gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],
                autoCloseBrackets: true
            }"
        ></ngx-codemirror>
    </div>
    
    <!-- Commands -->
    <div class="commands shadow-up">
        <app-commands #commands (onCommandExecuted)="this.handleCommand($event)"></app-commands>
    </div>
</div>

<!-- Minimized -->
<div
    class="container-minimized"
    *ngIf="minimized"
    matTooltip="Maximize"
    matTooltipPosition="right"
    (click)="toggleMinimize(false)"
>
    <mat-icon class="maximize-button">keyboard_double_arrow_right</mat-icon>
    <div class="header-separator"></div>
    <div class="title-minimized">
        {{ this.formattedName }}
    </div>
</div>